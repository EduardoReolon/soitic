(function(){"use strict";var e={3174:function(e,t,r){r(6992),r(8674),r(9601),r(7727);var n=r(144),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("button",{on:{click:function(t){return e.goToHome()}}},[e._v("Página inicial")]),r("button",{on:{click:function(t){return e.goToMovies()}}},[e._v("Filmes")]),r("button",{on:{click:function(t){return e.goToDirectors()}}},[e._v("Diretores")]),r("router-view")],1)},i=[],c=r(8345),s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login"},[r("h1",[e._v("Log-in")]),r("form",{on:{submit:e.requestLogin}},[e._m(0),e._m(1),r("input",{attrs:{type:"submit",value:"Log-in"}})])])},a=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",[r("b",[e._v("E-mail")]),r("input",{attrs:{id:"email",type:"email",required:""}})])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",[r("b",[e._v("Senha")]),r("input",{attrs:{id:"password",type:"password",required:""}})])}],u=r(3019),d=r(629),l={methods:(0,u.Z)((0,u.Z)({},(0,d.nv)("authField",["login"])),{},{requestLogin:function(e){e.preventDefault(),this.login({email:document.getElementById("email").value,password:document.getElementById("password").value})}})},f=l,v=r(1001),h=(0,v.Z)(f,s,a,!1,null,null,null),m=h.exports,p=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},g=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h1",[e._v("Home page")])])}],_={data:function(){return{}}},k=_,b=(0,v.Z)(k,p,g,!1,null,null,null),R=b.exports,w=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h2",[e._v("Filmes")]),r("List",{attrs:{list:e.movies,deleteRecord:e.deleteRecord,edditRecord:e.edditRecord}}),e.edditingMode?r("Item",{attrs:{item:this.movie,saveRecord:e.saveRecord,cancelUpdate:function(){e.edditingMode=!1},updateRecord:e.setMovieUpdate}}):e._e()],1)},D=[],M=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"divList"},[r("table",[r("tr",[r("td",[e._v("Id")]),r("td",[e._v("Nome")]),e.showDirector?r("td",[e._v("Diretor")]):e._e()]),e._l(e.list,(function(t,n){return r("tr",{key:n},[r("td",[e._v(e._s(t.id))]),r("td",[e._v(e._s(t.name))]),e.showDirector?r("td",[e._v(e._s(t.director_name))]):e._e(),r("td",[r("button",{on:{click:function(r){return e.deleteRecord({id:t.id})}}},[e._v("Deletar")])]),r("td",[r("button",{on:{click:function(r){return e.edditRecord({id:t.id})}}},[e._v("Editar")])])])}))],2),r("button",{on:{click:function(t){return e.edditRecord({id:-1})}}},[e._v("Novo item")])])},Z=[],y={props:{list:Array,showDirector:{type:Boolean,default:!0},deleteRecord:Function,edditRecord:Function}},L=y,T=(0,v.Z)(L,M,Z,!1,null,null,null),E=T.exports,O=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("label",[e._v(" Id "),r("input",{attrs:{type:"numeric",disabled:""},domProps:{value:e.item.id}})]),r("label",[e._v(" Nome "),r("input",{attrs:{type:"text"},domProps:{value:e.item.name},on:{change:function(t){return e.updateRecord({values:{name:t.target.value}})}}})]),e.showDirector?r("label",[e._v(" Diretor "),r("select",{domProps:{value:e.item.director_id},on:{change:function(t){e.updateRecord({values:{director_id:parseInt(t.target.value)}})}}},e._l(e.directors,(function(t,n){return r("option",{key:n,domProps:{value:t.id}},[e._v(e._s(t.name))])})),0)]):e._e(),r("button",{on:{click:function(t){return e.saveRecord()}}},[e._v("Salvar")]),r("button",{on:{click:function(t){return e.cancelUpdate()}}},[e._v("Cancelar")])])},x=[],U={props:{item:Object,showDirector:{type:Boolean,default:!0},saveRecord:Function,cancelUpdate:Function,updateRecord:Function},computed:(0,u.Z)({},(0,d.rn)("directors",["directors"]))},I=U,P=(0,v.Z)(I,O,x,!1,null,null,null),j=P.exports,$={mounted:function(){var e=this;this.fetchListDirectors({callback:function(){e.fetchListMovies({directors:e.directors})}})},data:function(){return{edditingMode:!1}},components:{List:E,Item:j},computed:(0,u.Z)((0,u.Z)({},(0,d.rn)("directors",["directors"])),(0,d.rn)("movies",["movies","movie"])),methods:(0,u.Z)((0,u.Z)((0,u.Z)((0,u.Z)({},(0,d.nv)("directors",["fetchListDirectors"])),(0,d.nv)("movies",["fetchListMovies","saveRecordMovies","deleteRecordMovies"])),(0,d.OI)("movies",["setMovie","setMovieUpdate"])),{},{deleteRecord:function(e){var t=this,r=e.id;this.deleteRecordMovies({id:r,callback:function(){t.fetchListMovies({directors:t.directors})}})},edditRecord:function(e){var t=e.id;this.setMovie({id:t}),this.edditingMode=!0},saveRecord:function(){var e=this;this.saveRecordMovies({callback:function(){e.edditingMode=!1,e.fetchListMovies({directors:e.directors})}})}})},F=$,q=(0,v.Z)(F,w,D,!1,null,null,null),S=q.exports,N=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h2",[e._v("Diretores")]),r("List",{attrs:{list:e.directors,showDirector:!1,deleteRecord:e.deleteRecord,edditRecord:e.edditRecord}}),e.edditingMode?r("Item",{attrs:{item:e.director,showDirector:!1,saveRecord:e.saveRecord,cancelUpdate:function(){e.edditingMode=!1},updateRecord:e.setDirectorUpdate}}):e._e()],1)},B=[],C={mounted:function(){this.fetchListDirectors()},data:function(){return{edditingMode:!1}},components:{List:E,Item:j},computed:(0,u.Z)({},(0,d.rn)("directors",["directors","director"])),methods:(0,u.Z)((0,u.Z)((0,u.Z)({},(0,d.nv)("directors",["fetchListDirectors","saveRecordDirectors","deleteRecordDirectors"])),(0,d.OI)("directors",["setDirector","setDirectorUpdate"])),{},{deleteRecord:function(e){var t=this,r=e.id;this.deleteRecordDirectors({id:r,callback:function(){t.fetchListDirectors()}})},edditRecord:function(e){var t=e.id;this.setDirector({id:t}),this.edditingMode=!0},saveRecord:function(){var e=this;this.saveRecordDirectors({callback:function(){e.edditingMode=!1,e.fetchListDirectors()}})}})},J=C,A=(0,v.Z)(J,N,B,!1,null,null,null),H=A.exports;n.Z.use(c.Z);var z=[{path:"/",name:"index",component:R},{path:"/login",name:"login",component:m},{path:"/movies",name:"movies",component:S},{path:"/directors",name:"directos",component:H}],W=new c.Z({mode:"history",base:"/",routes:z}),G=W,K={name:"App",methods:{goToHome:function(){G.push("/").catch((function(){}))},goToMovies:function(){G.push("/movies").catch((function(){}))},goToDirectors:function(){G.push("/directors").catch((function(){}))}}},Q=K,V=(0,v.Z)(Q,o,i,!1,null,null,null),X=V.exports,Y=(r(8309),r(6198)),ee=(r(5666),r(6699),r(2023),r(1539),r(9669)),te=r.n(ee),re={state:{}},ne="/api",oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.project_id,r=e.equipment_id,n=te().create({baseURL:ne,timeout:3e4,headers:{Authorization:"Bearer ".concat(re.state.token),project_id:t||re.project_id,equipment_id:r||re.equipment_id}});return n.interceptors.response.use((function(e){return e}),function(){var e=(0,Y.Z)(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=t.config,!(401===t.response.status||500===t.response.status&&t.response.data.stack.includes("JWTExpired"))||!re.state.refreshToken){e.next=8;break}return n=null,e.next=5,te().create({baseURL:ne,timeout:5e3}).post("v1/auth/refresh",{refresh_token:re.state.refreshToken}).then(function(){var e=(0,Y.Z)(regeneratorRuntime.mark((function e(t){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=t.data,re.state.token=o.token,re.state.refreshToken=o.refreshToken,r.headers.Authorization="Bearer ".concat(o.token),e.next=6,te().request(r).then((function(e){n=e})).catch((function(e){n=e}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){n=e}));case 5:if(200!==n.status&&201!==n.status){e.next=7;break}return e.abrupt("return",n);case 7:return e.abrupt("return",Promise.reject(n));case 8:return e.abrupt("return",Promise.reject(t));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n},ie={namespaced:!0,state:{token:null,refreshToken:null,loginError:null,user:{},email_new:null},actions:{login:function(e,t){var r=e.commit,n=e.dispatch,o=t.email,i=t.password;return r("setLoginError",null),oe().post("v1/auth/login",{email:o,password:i}).then((function(e){var t=e.data;r("setToken",{token:t.token,refreshToken:t.refreshToken}),n("me",{goToRoot:!0})})).catch((function(e){401===e.response.status?r("setLoginError","Usuário e/ou senha incorretos"):r("setLoginError","Ocorreu um erro ao tentar logar")}))},updateUser:function(e,t){var r=e.dispatch,n=e.state,o=t.name,i=t.surname,c=t.password;return oe().patch("v1/auth/update",{name:o,surname:i,password:c}).then((function(){c?r("login",{email:n.user.email,password:c}):r("me")}))},register:function(e,t){var r=e.state,n=t.institution_id;return!!r.email_new&&oe().post("v1/auth/register",{email:r.email_new,password:"123456",institution_id:n})},refreshToken:function(e,t){var r=e.state,n=e.commit,o=t.callback,i=t.callbackError;return n("setLoginError",null),oe().post("v1/auth/refresh",{refresh_token:r.refreshToken}).then((function(e){var t=e.data;n("setToken",{token:t.token,refreshToken:t.refreshToken}),o&&o()})).catch((function(e){401===e.response.status?n("setLoginError","Usuário e/ou senha incorretos"):n("setLoginError","Ocorreu um erro ao tentar logar"),i&&i()}))},me:function(e){var t=e.commit,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.goToRoot,o=void 0!==n&&n,i=r.callback;return oe().get("v1/auth/me").then((function(e){var r=e.data;t("setUser",r),o&&G.push("/").catch((function(){})),i&&i()})).catch((function(){o&&G.push("/login").catch((function(){}))}))},logout:function(e){var t=e.commit;return oe().post("v1/auth/logout").then((function(){t("setUser",{}),t("setToken",{token:null,refreshToken:null}),G.push("/login").catch((function(){}))}))},configPivot:function(e){var t=e.commit,r=e.state;re.state=new Proxy({},{get:function(e,t){return r[t]},set:function(e,r,n){return t("setPivot",{key:r,value:n}),!0}})}},getters:{isLoggedIn:function(e){return!!e.refreshToken},getUser:function(e){return e.user||{}}},mutations:{setLoginError:function(e,t){e.loginError=t},setUser:function(e,t){e.user=t},setToken:function(e,t){var r=t.token,n=t.refreshToken;e.token=r,e.refreshToken=n},setPivot:function(e,t){var r=t.key,n=t.value;e[r]=n},setEmail_new:function(e,t){e.email_new=t}}},ce=r(4479),se=r(9355),ae=(r(8862),r(561),r(4747),r(9826),r(3948),r(7941),{namespaced:!0,state:{movies:[],movie:{}},actions:{fetchListMovies:function(e){var t=e.commit,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.directors;return oe().get("MovieItems").then((function(e){var r=e.data;t("setMovies",{data:r,directors:n})}))},saveRecordMovies:function(e){var t=e.state,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.callback,o=t.movie.id<0?"post":"put",i=JSON.parse(JSON.stringify(t.movie)),c="post"===o?"":"/".concat(i.id);return"post"===o&&delete i.id,oe()[o]("MovieItems".concat(c),i).then((function(){n&&n()}))},deleteRecordMovies:function(e){(0,se.Z)(e);var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.id,n=t.callback;return oe().delete("MovieItems/".concat(r)).then((function(){n&&n()}))}},getters:{},mutations:{setMovies:function(e,t){var r,n=t.data,o=t.directors;e.movies.splice(0),n.forEach((function(e){var t=o.find((function(t){return t.id===e.director_id}));t&&(e.director_name=t.name)})),(r=e.movies).push.apply(r,(0,ce.Z)(n))},setMovie:function(e,t){var r=t.id;e.movie=e.movies.find((function(e){return e.id===r}))||{id:r}},setMovieUpdate:function(e,t){var r=t.movie,n=t.values,o=r||e.movie;Object.keys(n).forEach((function(e){o[e]=n[e]}))}}}),ue={namespaced:!0,state:{directors:[],director:{}},actions:{fetchListDirectors:function(e){var t=e.commit,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.callback;return oe().get("DirectorItems").then((function(e){var r=e.data;t("setDirectors",{data:r}),n&&n()}))},saveRecordDirectors:function(e){var t=e.state,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.callback,o=t.director.id<0?"post":"put",i=JSON.parse(JSON.stringify(t.director)),c="post"===o?"":"/".concat(i.id);return"post"===o&&delete i.id,oe()[o]("DirectorItems".concat(c),i).then((function(){n&&n()}))},deleteRecordDirectors:function(e){(0,se.Z)(e);var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.id,n=t.callback;return oe().delete("DirectorItems/".concat(r)).then((function(){n&&n()}))}},getters:{},mutations:{setDirectors:function(e,t){var r,n=t.data;e.directors.splice(0),(r=e.directors).push.apply(r,(0,ce.Z)(n))},setDirector:function(e,t){var r=t.id;e.director=e.directors.find((function(e){return e.id===r}))||{id:r}},setDirectorUpdate:function(e,t){var r=t.values;Object.keys(r).forEach((function(t){e.director[t]=r[t]}))}}};n.Z.use(d.ZP);var de=new d.ZP.Store({strict:!0,state:{},modules:{authentication:ie,movies:ae,directors:ue},mutations:{setState:function(e,t){var r=t.key,n=t.value;e[r]=n}},actions:{},plugins:[]});n.Z.config.productionTip=!1,new n.Z({router:G,store:de,render:function(e){return e(X)}}).$mount("#app")}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.m=e,function(){var e=[];r.O=function(t,n,o,i){if(!n){var c=1/0;for(d=0;d<e.length;d++){n=e[d][0],o=e[d][1],i=e[d][2];for(var s=!0,a=0;a<n.length;a++)(!1&i||c>=i)&&Object.keys(r.O).every((function(e){return r.O[e](n[a])}))?n.splice(a--,1):(s=!1,i<c&&(c=i));if(s){e.splice(d--,1);var u=o();void 0!==u&&(t=u)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[n,o,i]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};r.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,i,c=n[0],s=n[1],a=n[2],u=0;if(c.some((function(t){return 0!==e[t]}))){for(o in s)r.o(s,o)&&(r.m[o]=s[o]);if(a)var d=a(r)}for(t&&t(n);u<c.length;u++)i=c[u],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(d)},n=self["webpackChunkclient"]=self["webpackChunkclient"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=r.O(void 0,[998],(function(){return r(3174)}));n=r.O(n)})();
//# sourceMappingURL=app-legacy.ad4f7cb1.js.map